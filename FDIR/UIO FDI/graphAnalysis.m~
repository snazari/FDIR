%% Graph Analysis of UIO Fault Detection Schemes
%  Sam Nazari
%  06-July-2015

%%%| z_1^1 | z_2^1 | z_3^1 | z_4^1 | u_1 | u_2 | u_3 | y_1 | y_2 | y_3|y_4|
%--------------------------------------------------------------------------
zd11=[ 1,     1,      1,      0,      1,    0,    0,    1,     1,  1];%,   0];
zd12=[ 1,     1,      1,      1,      0,    1,    0,    1,     1,  1];%,   0];
zd13=[ 1,     1,      1,      1,      0,    1,    0,    1,     1,  1];%,   0];
zd14=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  1];%,   0];
r11 =[ 1,     0,      0,      0,      0,    0,    0,    1,     0,  0];%,   0];
r12 =[ 0,     1,      0,      0,      0,    0,    0,    0,     1,  0];%,   0];
r13 =[ 0,     0,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
r14 =[ 0,     0,      0,      0,      0,    0,    0,    0,     0,  0];%,   1];

%%%| z_1^2 | z_2^2 | z_3^2 | z_4^2 | u_1 | u_2 | u_3 | y_1 | y_2 | y_3|y_4|
%--------------------------------------------------------------------------
zd21=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  0];%,   0];
zd22=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  0];%,   0];
zd23=[ 1,     1,      1,      0,      0,    0,    0,    1,     1,  0];%,   0];
zd24=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  1];%,   0];
r21 =[ 1,     0,      0,      0,      0,    0,    0,    1,     1,  0];%,   0];
r22 =[ 0,     1,      0,      0,      0,    0,    0,    1,     1,  0];%,   0];
r23 =[ 0,     0,      1,      0,      0,    0,    0,    0,     0,  0];%,   0];
r24 =[ 0,     0,      0,      0,      0,    0,    0,    0,     0,  0];%,   1];

B1 = [zd11;zd12;zd13;zd14;r11;r12;r13];
B2 = [zd21;zd22;zd23;zd24;r21;r22;r23];

B1t=B1';
B1t=B1t(:,5:7)

B2t=B2';
B2t=B2t(:,5:7)

B = [B1t B2t]

%% for V3, we try three UIOs

%------UIO 1--------%
%%%| z_1^1 | z_2^1 | z_3^1 | z_4^1 | u_1 | u_2 | u_3 | y_1 | y_2 | y_3|y_4|
%--------------------------------------------------------------------------
zd11=[ 1,     1,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
zd12=[ 1,     1,      1,      1,      0,    0,    0,    0,     0,  1];%,   0];
zd13=[ 1,     1,      1,      1,      0,    0,    0,    0,     0,  1];%,   0];
zd14=[ 1,     1,      1,      1,      0,    0,    0,    0,     1,  1];%,   0];
r11 =[ 0,     0,      0,      0,      0,    0,    0,    1,     0,  0];%,   0];
r12 =[ 0,     0,      0,      0,      0,    0,    0,    0,     1,  0];%,   0];
r13 =[ 0,     0,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
r14 =[ 0,     0,      0,      1,      0,    0,    0,    0,     0,  0];%,   1];

%------UIO 2--------%
%%%| z_1^2 | z_2^2 | z_3^2 | z_4^2 | u_1 | u_2 | u_3 | y_1 | y_2 | y_3|y_4|
%--------------------------------------------------------------------------
zd12=[ 1,     1,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
zd22=[ 1,     1,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
zd32=[ 1,     1,      1,      1,      0,    0,    0,    0,     0,  1];%,   0];
zd42=[ 1,     1,      1,      1,      0,    0,    0,    0,     1,  1];%,   0];
r12 =[ 0,     0,      0,      0,      0,    0,    0,    1,     0,  0];%,   0];
r22 =[ 0,     0,      0,      0,      0,    0,    0,    0,     1,  0];%,   0];
r32 =[ 0,     0,      1,      0,      0,    0,    0,    0,     0,  1];%,   0];
r42 =[ 0,     0,      0,      1,      0,    0,    0,    0,     0,  0];%,   1];

%------UIO 3--------%
%%%| z_1^3 | z_2^3 | z_3^3 | z_4^3 | u_1 | u_2 | u_3 | y_1 | y_2 | y_3|y_4|
%--------------------------------------------------------------------------
zd13=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  0];%,   0];
zd23=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  0];%,   0];
zd33=[ 1,     1,      1,      0,      0,    0,    0,    1,     1,  0];%,   0];
zd43=[ 1,     1,      1,      1,      0,    0,    0,    1,     1,  1];%,   0];
r13 =[ 1,     1,      0,      0,      0,    0,    0,    1,     0,  0];%,   0];
r23 =[ 1,     1,      0,      0,      0,    0,    0,    0,     1,  0];%,   0];
r33 =[ 0,     0,      0,      0,      0,    0,    0,    0,     0,  1];%,   0];
r43 =[ 0,     0,      0,      1,      0,    0,    0,    0,     0,  0];%,   1];

Buio1 = [